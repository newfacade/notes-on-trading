Processing queries:   0%|          | 0/81 [00:00<?, ?it/s]Processing queries:   0%|          | 0/81 [01:44<?, ?it/s]
Traceback (most recent call last):
  File "/Users/xiayunhui/github/LeetCodeDataset/data_process/deepseek_query.py", line 60, in main
    for future in tqdm(concurrent.futures.as_completed(futures), total=len(futures), desc="Processing queries"):
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/Users/xiayunhui/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/Users/xiayunhui/miniconda3/lib/python3.12/threading.py", line 655, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/xiayunhui/github/LeetCodeDataset/data_process/deepseek_query.py", line 68, in <module>
    main()
  File "/Users/xiayunhui/github/LeetCodeDataset/data_process/deepseek_query.py", line 57, in main
    with concurrent.futures.ThreadPoolExecutor(max_workers=args.threads) as executor:
  File "/Users/xiayunhui/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 647, in __exit__
    self.shutdown(wait=True)
  File "/Users/xiayunhui/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 238, in shutdown
    t.join()
  File "/Users/xiayunhui/miniconda3/lib/python3.12/threading.py", line 1147, in join
    self._wait_for_tstate_lock()
  File "/Users/xiayunhui/miniconda3/lib/python3.12/threading.py", line 1167, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in: <module 'threading' from '/Users/xiayunhui/miniconda3/lib/python3.12/threading.py'>
Traceback (most recent call last):
  File "/Users/xiayunhui/miniconda3/lib/python3.12/threading.py", line 1592, in _shutdown
    atexit_call()
  File "/Users/xiayunhui/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 31, in _python_exit
    t.join()
  File "/Users/xiayunhui/miniconda3/lib/python3.12/threading.py", line 1147, in join
    self._wait_for_tstate_lock()
  File "/Users/xiayunhui/miniconda3/lib/python3.12/threading.py", line 1167, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt: 
Processing queries:   0%|          | 0/81 [00:00<?, ?it/s]Processing queries:   1%|          | 1/81 [03:58<5:17:35, 238.20s/it]Processing queries:   1%|          | 1/81 [10:00<13:20:08, 600.11s/it]
Traceback (most recent call last):
  File "/Users/xiayunhui/github/LeetCodeDataset/data_process/deepseek_query.py", line 92, in <module>
    print(f"Temporary file {tmp_file} has been deleted")
^^^^^^
  File "/Users/xiayunhui/github/LeetCodeDataset/data_process/deepseek_query.py", line 77, in main
    futures = [executor.submit(process_item, item, client, args.model, args.system, tmp_file) for item in data]
                       ^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/Users/xiayunhui/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/github/LeetCodeDataset/data_process/deepseek_query.py", line 23, in process_item
    def process_item(item, client, model, system_prompt, tmp_file):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/openai/_utils/_utils.py", line 277, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 643, in create
    return self._post(
           ^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/openai/_base_client.py", line 1250, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/openai/_base_client.py", line 931, in request
    return self._request(
           ^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/openai/_base_client.py", line 1032, in _request
    return self._process_response(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/openai/_base_client.py", line 1126, in _process_response
    return api_response.parse()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/openai/_response.py", line 311, in parse
    parsed = self._parse(to=to)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/openai/_response.py", line 251, in _parse
    data = response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/site-packages/httpx/_models.py", line 764, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/xiayunhui/miniconda3/lib/python3.12/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 10 column 1 (char 9)
